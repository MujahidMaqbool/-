<div aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog-centered">
        <div class="modal-content large_popup">
            <div class="activity_tabs_popup">
                <div class="row">
                    <mat-tab-group class="col-sm-12 col-md-12 no_padding" (selectedTabChange)="onTabChange($event)" [selectedIndex]="activeTabIndex">
                        <mat-tab label="{{activityTypes.Call}}" *ngIf="tabsOptions && tabsOptions.activeTabs && tabsOptions.activeTabs.indexOf(activityTypes.Call) > -1">
                            <div *ngTemplateOutlet="errormessage"></div>
                            <div *ngTemplateOutlet="call"></div>
                        </mat-tab>
                        <mat-tab label="{{activityTypes.FollowupCall}}" *ngIf="tabsOptions && tabsOptions.activeTabs && tabsOptions.activeTabs.indexOf(activityTypes.FollowupCall) > -1">
                            <div *ngTemplateOutlet="errormessage"></div>
                            <div *ngTemplateOutlet="call"></div>
                        </mat-tab>
                        <mat-tab label="{{activityTypes.Appointment}}" *ngIf="tabsOptions && tabsOptions.activeTabs && tabsOptions.activeTabs.indexOf(activityTypes.Appointment) > -1">
                            <div *ngTemplateOutlet="errormessage"></div>
                            <div *ngTemplateOutlet="appointment"></div>
                        </mat-tab>
                        <mat-tab label="{{activityTypes.FollowupAppointment}}" *ngIf="tabsOptions && tabsOptions.activeTabs && tabsOptions.activeTabs.indexOf(activityTypes.FollowupAppointment) > -1">
                            <div *ngTemplateOutlet="errormessage"></div>
                            <div *ngTemplateOutlet="appointment"></div>
                        </mat-tab>
                        <mat-tab label="{{activityTypes.Email}}" *ngIf="personInfo?.EmailAllowed && tabsOptions && tabsOptions.activeTabs && tabsOptions.activeTabs.indexOf(activityTypes.Email) > -1">
                            <div *ngTemplateOutlet="errormessage"></div>
                            <div *ngTemplateOutlet="email"></div>
                        </mat-tab>
                        <mat-tab label="{{activityTypes.SMS}}" *ngIf="personInfo?.SMSAllowed && tabsOptions && tabsOptions.activeTabs && tabsOptions.activeTabs.indexOf(activityTypes.SMS) > -1">
                            <div *ngTemplateOutlet="errormessage"></div>
                            <div *ngTemplateOutlet="sms"></div>
                        </mat-tab>
                        <mat-tab label="{{activityTypes.Note}}" *ngIf="tabsOptions && tabsOptions.activeTabs && tabsOptions.activeTabs.indexOf(activityTypes.Note) > -1">
                            <div *ngTemplateOutlet="errormessage"></div>
                            <div *ngTemplateOutlet="note"></div>
                        </mat-tab>
                        <mat-tab label="{{activityTypes.Achievements}}" *ngIf="tabsOptions && tabsOptions.activeTabs && tabsOptions.activeTabs.indexOf(activityTypes.Achievements) > -1">
                            <div *ngTemplateOutlet="errormessage"></div>
                            <div *ngTemplateOutlet="Achievements"></div>
                        </mat-tab>
                        <mat-tab label="{{activityTypes.AppNotification}}" *ngIf="personInfo?.AppNotificationAllowed && tabsOptions && tabsOptions.activeTabs && tabsOptions.activeTabs.indexOf(activityTypes.AppNotification) > -1">
                            <div *ngTemplateOutlet="errormessage"></div>
                            <div *ngTemplateOutlet="appNotification"></div>
                        </mat-tab>
                    </mat-tab-group>
                </div>
            </div>
            <div class="row">
                <div class="popup_footer col-sm-12 col-md-12">
                    <div class="cancel_btn float-right">
                        <button tabindex="104" mat-button (click)="closePopup()">Cancel</button>
                        <button class="save primary_blue_btn" tabindex="105" *ngIf="!isActiveTabEmailOrSMS && !tabsOptions.isMarkAsDone" [disabled]="saveInProgress || isInvalidFollowUpDate" (click)="onSaveClick()">Save</button>
                        <button tabindex="105" class="save primary_blue_btn" *ngIf="!isActiveTabEmailOrSMS && tabsOptions.isMarkAsDone" [disabled]="saveInProgress || isInvalidFollowUpDate" (click)="onSaveClick()">Complete</button>
                        <button tabindex="105" class="save primary_blue_btn" *ngIf="isActiveTabEmailOrSMS && personInfo.Mobile || activeTab == activityTypes.Email || activeTab == activityTypes.AppNotification" [disabled]="saveInProgress" (click)="onSaveClick()">Send </button>

                    </div>

                </div>

            </div>
        </div>
    </div>
</div>

<!-- Messages Template -->
<ng-template #errormessage>
    <div class="row">
        <div class="col-sm-12 col-md-12">
            <div class="alert alert-danger" *ngIf="isInvalidData">
                {{messages.Validation.Info_Required}}
            </div>
            <div class="alert alert-danger" *ngIf="isInvalidEndTime">
                {{messages.Validation.Endtime_Should_Greater_Than_Start_Time}}
            </div>
            <div class="alert alert-danger" *ngIf="isInvalidEmailBody">
                {{emailMaxLengthMessage}}
            </div>
        </div>
    </div>
</ng-template>

<!-- Person Info Template -->
<ng-template #personinfo>
    <div class="row view_main_bar border_bottom">
        <div class="activity_person_info">
            <span><i class="fal fa-user"></i> {{personInfo.Name}}</span>
            <span class="enq_status"> {{personInfo.CustomerTypeName}}</span>
        </div>
        <div class="activity_person_info">
            <i class="fal fa-envelope"></i> {{personInfo.Email}}
        </div>
        <div class="activity_person_info" *ngIf="personInfo.Mobile">
            <i class="fal fa-mobile"></i> {{personInfo.Mobile}}
        </div>
    </div>
</ng-template>

<!-- Appointment Template -->
<ng-template #appointment>
    <form #appointmentForm="ngForm" novalidate>
        <div class="popup_content add_activity_height cstm_scroll_bg no_padding">
            <div class="row">
                <div class="col-md-12">
                    <div class="row mob-col-full">
                        <div *ngIf="personInfo" class="col-md-12 col-sm-12 activity_bar_info">
                            <div *ngTemplateOutlet="personinfo"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row sch_mob_reverse">
                <div class="col-lg-4 col-md-5 padding_right parallel_grid">
                    <div class="sch_white_bg mob-sm-sche">
                        <div class="smallScheduler" *ngIf="activeTab === activityTypes.Appointment || activeTab === activityTypes.FollowupAppointment">
                            <one-day-scheduler [dayViewFormat]="dayViewFormat" [schedulerTimeFormat]="schedulerTimeFormat" [staffID]="appointmentModel.AssignedToStaffID" [startDate]="currentAppointmentDate" #onedaySchedulerAppointmentComp (onStartDateChange)="onAppointmentDateChange($event)"
                                [minDate]="schedulerMinDate" [maxDate]="schedulerMaxDate"></one-day-scheduler>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8 col-md-7 parallel_grid">
                    <div class="sch_white_bg pt-2">
                        <div class="smallScheduler">
                            <div class="row">
                                <div class="col-md-6">
                                    <h5 class="field_label">Select Date</h5>
                                    <date-picker [disabled]="appointmentModel.IsNow" [value]="appointmentModel.FollowUpDate" [showClear]="false" (onDateChange)="onSelectDateAppointmentValueChanged($event)">
                                    </date-picker>
                                </div>
                                <div class="col-md-6" *ngIf="!tabsOptions.isEditMode">
                                    <h5 class="field_label">When</h5>
                                    <input type="radio" name="rdoApptmntNowLater" id="rdoApptmntNow" [(ngModel)]="appointmentModel.IsNow" [value]="true" [checked]="appointmentModel.IsNow" (ngModelChange)="onAppointmentChangeToNow()" />
                                    <label for="rdoApptmntNow"><span></span>Now</label> &nbsp; &nbsp; &nbsp;
                                    <input type="radio" name="rdoApptmntNowLater" id="rdoApptmntLater" [(ngModel)]="appointmentModel.IsNow" [value]="false" [checked]="appointmentModel.IsNow" (ngModelChange)="onAppointmentChangeToNow()" />
                                    <label for="rdoApptmntLater"><span></span>Later</label>
                                </div>
                                <div class="col-md-6">
                                    <h5 class="field_label">Title</h5>
                                    <div [ngClass]="{
                                       'has-danger': appointmentTitle.invalid && (appointmentTitle.dirty || appointmentTitle.touched || isInvalidData),
                                       'has-success': appointmentTitle.valid && (appointmentTitle.dirty || appointmentTitle.touched)
                                    }">
                                        <input class="form-control" type="text" name="appointmentTitle" [(ngModel)]="appointmentModel.Title" #appointmentTitle="ngModel" maxlength="50" required />
                                    </div>
                                </div>
                                <div class="col-md-6" *ngIf="!appointmentModel.IsNow">
                                    <h5 class="field_label">Assigned To</h5>
                                    <div [ngClass]="{
                                    'has-danger': assignedToStaffID.invalid && (assignedToStaffID.dirty || assignedToStaffID.touched || isInvalidData),
                                    'has-success': assignedToStaffID.valid && (assignedToStaffID.dirty || assignedToStaffID.touched)
                                }">
                                        <div class="select_label">
                                            <select class="form-control" name="assignedTo" [(ngModel)]="appointmentModel.AssignedToStaffID" (ngModelChange)="onAppointmentStaffChange(appointmentModel.AssignedToStaffID)" #assignedToStaffID="ngModel" required>
                                        <option *ngFor="let staff of staffList" [ngValue]="staff.StaffID">
                                            {{staff.StaffFullName}}
                                        </option>
                                    </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h5 class="field_label">Contact Reason </h5>
                                    <div [ngClass]="{
                                    'has-danger': apptContactReasonID.invalid && (apptContactReasonID.dirty || apptContactReasonID.touched || isInvalidData),
                                    'has-success': apptContactReasonID.valid && (apptContactReasonID.dirty || apptContactReasonID.touched)
                                }">
                                        <div class="select_label">
                                            <select class="form-control" name="apptContactReasonID" [(ngModel)]="appointmentModel.ContactReasonTypeID" #apptContactReasonID="ngModel" required>
                                        <option *ngFor="let constactReasonType of contactReasonList"
                                            [ngValue]="constactReasonType.ContactReasonTypeID">
                                            {{constactReasonType.ContactReasonTypeName}}
                                        </option>
                                    </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12" *ngIf="appointmentModel.IsNow">
                                    <h5 class="field_label">Outcome</h5>
                                    <span *ngFor="let outcome of outcomeList" class="radio_space">
                                <input type="radio" name="rdoApptmntOutcomeID"
                                    id="{{'rdoApptmntOutcomeID' + outcome.ActivityOutcomeID}}"
                                    [(ngModel)]="appointmentModel.ActivityOutcomeID"
                                    (ngModelChange)="onAppointmentOutcomeChange()"
                                    [value]="outcome.ActivityOutcomeID" />
                                <label
                                    for="{{'rdoApptmntOutcomeID' + outcome.ActivityOutcomeID}}"><span></span>{{outcome.ActivityOutComeName}}</label>
                                    &nbsp; &nbsp;
                                    </span>
                                </div>
                                <div class="col-md-12" *ngIf="appointmentModel.IsNow">
                                    <h5 class="field_label">What’s Next</h5>
                                    <span *ngFor="let whatNext of whatNextList" class="radio_space">
                                <input type="radio" name="rdoApptWhatNextID"
                                    id="{{'rdoApptWhatNextID' + whatNext.ActivityWhatNextID}}"
                                    [(ngModel)]="appointmentModel.ActivityWhatNextID"
                                    [value]="whatNext.ActivityWhatNextID" [disabled]="isApptOutcomeSaleOrLost" />
                                <label
                                    for="{{'rdoApptWhatNextID' + whatNext.ActivityWhatNextID}}"><span></span>{{whatNext.ActivityWhatNextName}}</label>
                                    &nbsp; &nbsp;
                                    </span>
                                </div>
                                <div class="col-md-6" *ngIf="!appointmentModel.IsNow">
                                    <h5 class="field_label">Start Time</h5>
                                    <dx-date-box class="full_width" type="time" [displayFormat]="schedulerTimeFormat" [useMaskBehavior]="true" [interval]="15" (onValueChanged)="onAppointmentStartTimeChanged($event)" [(value)]="schedulerStartTime">
                                        <dx-validator>
                                            <dxi-validation-rule type="required"></dxi-validation-rule>
                                        </dx-validator>
                                    </dx-date-box>
                                </div>
                                <div class="col-md-6" *ngIf="!appointmentModel.IsNow">
                                    <h5 class="field_label">End Time</h5>
                                    <dx-date-box class="full_width" type="time" [displayFormat]="schedulerTimeFormat" [useMaskBehavior]="true" [interval]="15" (onValueChanged)="onAppointmentEndTimeChanged($event)" [(value)]="schedulerEndTime">
                                        <dx-validator>
                                            <dxi-validation-rule type="required"></dxi-validation-rule>
                                        </dx-validator>
                                    </dx-date-box>
                                </div>
                                <div class="col-lg-6 col-md-8 " *ngIf="appointmentModel.IsNow && isAppointmentTrialEndRequired">
                                    <h5 class="field_label">Trial End</h5>
                                    <div [ngClass]="{
                                'has-danger': TrialEndDate.invalid && (TrialEndDate.dirty || TrialEndDate.touched || isInvalidData),
                                'has-success': TrialEndDate.valid && (TrialEndDate.dirty || TrialEndDate.touched)
                            }">
                                        <input name="FollowUpDate" class="form-control date-picker" [min]="minDate" [(ngModel)]="appointmentModel.TrialEndDate" #TrialEndDate="ngModel" matInput [matDatepicker]="picker" placeholder="Choose a date" required />
                                    </div>
                                    <mat-datepicker #picker></mat-datepicker>
                                    <mat-datepicker-toggle class="date-picker-toggle" matSuffix [for]="picker">
                                    </mat-datepicker-toggle>
                                </div>
                                <div class="col-lg-6 col-md-8 " *ngIf="(appointmentModel.IsNow && (appointmentModel.ActivityOutcomeID === outcomeType.Lead_Apt_Lost))">
                                    <h5 class="field_label">Lost Reason</h5>
                                    <div [ngClass]="{
                                                'has-danger': lostReasonTypeID.invalid && (lostReasonTypeID.dirty || lostReasonTypeID.touched || isInvalidData),
                                                'has-success': lostReasonTypeID.valid && (lostReasonTypeID.dirty || lostReasonTypeID.touched)
                                            }">
                                        <div class="select_label">
                                            <select class="form-control" name="lostReason" [(ngModel)]="appointmentModel.LostReasonTypeID" #lostReasonTypeID="ngModel" required>
                                        <option *ngFor="let lostReason of lostReasonList"
                                            [ngValue]="lostReason.LostReasonTypeID">
                                            {{lostReason.LostReasonTypeName}}
                                        </option>
                                    </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <h5 class="field_label">Notes <span>(Remaining Characters: {{ 250 -
                                    appointmentModel?.Description?.length }})</span></h5>
                                    <div *ngIf="isAppointmentLostReasonRequired" [ngClass]="{
                                               'has-danger': appointmentModelNoteReq.invalid && (appointmentModelNoteReq.dirty || appointmentModelNoteReq.touched || isInvalidData),
                                               'has-success': appointmentModelNoteReq.valid && (appointmentModelNoteReq.dirty || appointmentModelNoteReq.touched)
                                            }">
                                        <textarea class="form-control form-control-description" rows="3" name="appointmentModelNoteReq" #appointmentModelNoteReq="ngModel" [(ngModel)]="appointmentModel.Description" maxlength="250" required>
                            </textarea>
                                    </div>

                                    <div *ngIf="!isAppointmentLostReasonRequired">
                                        <textarea class="form-control form-control-description" rows="3" name="appointmentModelNote" [(ngModel)]="appointmentModel.Description" maxlength="250">
                            </textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</ng-template>

<!-- Call Template -->
<ng-template #call>
    <form #callForm="ngForm" novalidate>
        <div class="popup_content add_activity_height cstm_scroll_bg no_padding">
            <div class="row">
                <div class="col-md-12">
                    <div class="row mob-col-full">
                        <div *ngIf="personInfo" class="col-md-12 col-sm-12 activity_bar_info">
                            <div *ngTemplateOutlet="personinfo"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row sch_mob_reverse">
                <div class="col-lg-4 col-md-5 padding_right parallel_grid">
                    <div class="sch_white_bg mob-sm-sche">
                        <div class="smallScheduler">
                            <div *ngIf="activeTab === activityTypes.Call || activeTab === activityTypes.FollowupCall">
                                <one-day-scheduler [dayViewFormat]="dayViewFormat" [staffID]="callModel.AssignedToStaffID" [schedulerTimeFormat]="schedulerTimeFormat" [startDate]="currentCallDate" #onedaySchedulerCallComp (onStartDateChange)="onCallDateChange($event)" [minDate]="schedulerMinDate"
                                    [maxDate]="schedulerMaxDate"></one-day-scheduler>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8 col-md-7 parallel_grid">
                    <div class="sch_white_bg">
                        <div class="smallScheduler">
                            <div class="row">
                                <div class="col-md-6">
                                    <h5 class="field_label">Select Date</h5>
                                    <date-picker [disabled]="callModel.IsNow" [value]="callModel.FollowUpDate" [showClear]="false" (onDateChange)="onSelectDateCallValueChanged($event)">
                                    </date-picker>
                                </div>
                                <div class="col-md-6" *ngIf="!tabsOptions.isEditMode">
                                    <h5 class="field_label">When</h5>
                                    <input type="radio" name="rdoCallNowLater" id="rdoCallNow" [(ngModel)]="callModel.IsNow" [value]="true" [checked]="callModel.IsNow" (ngModelChange)="onCallChangeToNow()" />
                                    <label for="rdoCallNow"><span></span>Now</label>&nbsp; &nbsp; &nbsp;
                                    <input type="radio" name="rdoCallNowLater" id="rdoCallLater" [(ngModel)]="callModel.IsNow" [value]="false" [checked]="callModel.IsNow" (ngModelChange)="onCallChangeToNow()" />
                                    <label for="rdoCallLater"><span></span>Later</label>
                                </div>
                                <div class="col-md-6">
                                    <h5 class="field_label">Title</h5>
                                    <div [ngClass]="{
                                   'has-danger': callTitle.invalid && (callTitle.dirty || callTitle.touched || isInvalidData),
                                   'has-success': callTitle.valid && (callTitle.dirty || callTitle.touched)
                                }">
                                        <input class="form-control" type="text" name="callTitle" [(ngModel)]="callModel.Title" #callTitle="ngModel" maxlength="50" required />
                                    </div>
                                </div>
                               
                                <div class="col-md-6">
                                    <h5 class="field_label">Contact Reason</h5>
                                    <div [ngClass]="{
                                    'has-danger': callContactReasonID.invalid && (callContactReasonID.dirty || callContactReasonID.touched || isInvalidData),
                                    'has-success': callContactReasonID.valid && (callContactReasonID.dirty || callContactReasonID.touched)
                                }">
                                        <div class="select_label">
                                            <select class="form-control" name="callContactReasonID" [(ngModel)]="callModel.ContactReasonTypeID" #callContactReasonID="ngModel" required>
                                        <option *ngFor="let constactReasonType of contactReasonList"
                                            [ngValue]="constactReasonType.ContactReasonTypeID">
                                            {{constactReasonType.ContactReasonTypeName}}
                                        </option>
                                    </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6" *ngIf="!callModel.IsNow">
                                    <h5 class="field_label">Assign To</h5>
                                    <div [ngClass]="{
                                        'has-danger': callAssignedToStaffID.invalid && (callAssignedToStaffID.dirty || callAssignedToStaffID.touched || isInvalidData),
                                        'has-success': callAssignedToStaffID.valid && (callAssignedToStaffID.dirty || callAssignedToStaffID.touched)
                                    }">
                                        <div class="select_label">
                                            <select class="form-control" name="callAssignedTo" [(ngModel)]="callModel.AssignedToStaffID" (ngModelChange)="onCallStaffChange(callModel.AssignedToStaffID)" #callAssignedToStaffID="ngModel" required>
                                        <option *ngFor="let staff of staffList" [ngValue]="staff.StaffID">
                                            {{staff.StaffFullName}}
                                        </option>
                                    </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12" *ngIf="callModel.IsNow">
                                    <h5 class="field_label">Outcome</h5>
                                    <span *ngFor="let outcome of outcomeList" class="radio_space">
                                <input type="radio" name="rdoCallOutcomeID"
                                    id="{{'rdoCallOutcomeID' + outcome.ActivityOutcomeID}}"
                                    [(ngModel)]="callModel.ActivityOutcomeID" [value]="outcome.ActivityOutcomeID" />
                                <label
                                    for="{{'rdoCallOutcomeID' + outcome.ActivityOutcomeID}}"><span></span>{{outcome.ActivityOutComeName}}</label>
                                    &nbsp; &nbsp;
                                    </span>
                                </div>
                                <div class="col-md-12" *ngIf="callModel.IsNow">
                                    <h5 class="field_label">What’s Next</h5>
                                    <span *ngFor="let whatNext of whatNextList" class="radio_space">
                                <input type="radio" name="rdoCallWhatNextID"
                                    id="{{'rdoCallWhatNextID' + whatNext.ActivityWhatNextID}}"
                                    [(ngModel)]="callModel.ActivityWhatNextID" (ngModelChange)="onCallWhatNextChange()"
                                    [value]="whatNext.ActivityWhatNextID" />
                                <label
                                    for="{{'rdoCallWhatNextID' + whatNext.ActivityWhatNextID}}"><span></span>{{whatNext.ActivityWhatNextName}}</label>
                                    &nbsp; &nbsp;
                                    </span>
                                </div>
                                <div class="col-md-6" *ngIf="!callModel.IsNow">
                                    <h5 class="field_label">Start Time</h5>
                                    <dx-date-box type="time" [displayFormat]="schedulerTimeFormat" [interval]="15" [useMaskBehavior]="true" (onValueChanged)="onCallStartTimeChanged($event)" [(value)]="schedulerStartTime" class="full_width">
                                        <dx-validator>
                                            <dxi-validation-rule type="required"></dxi-validation-rule>
                                        </dx-validator>
                                    </dx-date-box>
                                </div>
                                <div class="col-md-6" *ngIf="!callModel.IsNow">
                                    <h5 class="field_label">End Time</h5>
                                    <dx-date-box type="time" [displayFormat]="schedulerTimeFormat" [interval]="15" [useMaskBehavior]="true" (onValueChanged)="onCallEndTimeChanged($event)" [(value)]="schedulerEndTime" class="full_width">
                                        <dx-validator>
                                            <dxi-validation-rule type="required"></dxi-validation-rule>
                                        </dx-validator>
                                    </dx-date-box>
                                </div>
                                <div class="col-lg-6 col-md-12" *ngIf="(callModel.IsNow && isCallLostReasonRequired)">
                                    <h5 class="field_label">Lost Reason</h5>
                                    <div [ngClass]="{
                                                 'has-danger': callLostReasonTypeID.invalid && (callLostReasonTypeID.dirty || callLostReasonTypeID.touched || isInvalidData),
                                                 'has-success': callLostReasonTypeID.valid && (callLostReasonTypeID.dirty || callLostReasonTypeID.touched)
                                            }">
                                        <div class="select_label">
                                            <select class="form-control" name="callLostReason" [(ngModel)]="callModel.LostReasonTypeID" #callLostReasonTypeID="ngModel" required>
                                        <option *ngFor="let lostReason of lostReasonList"
                                            [ngValue]="lostReason.LostReasonTypeID">
                                            {{lostReason.LostReasonTypeName}}
                                        </option>
                                    </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <h5 class="field_label">Notes <span>(Remaining Characters: {{ 250 -
                                    callModel?.Description?.length }}) </span></h5>
                                    <div *ngIf="isCallLostReasonRequired" [ngClass]="{
                                               'has-danger': callModelNoteReq.invalid && (callModelNoteReq.dirty || callModelNoteReq.touched || isInvalidData),
                                               'has-success': callModelNoteReq.valid && (callModelNoteReq.dirty || callModelNoteReq.touched)
                                            }">
                                        <textarea class="form-control form-control-description" rows="3" name="callModelNoteReq" #callModelNoteReq="ngModel" [(ngModel)]="callModel.Description" maxlength="250" required>
                                </textarea>
                                    </div>
                                    <div *ngIf="!isCallLostReasonRequired">
                                        <textarea class="form-control form-control-description" rows="3" name="callModelNote" [(ngModel)]="callModel.Description" maxlength="250">
                            </textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</ng-template>

<!-- Email Template -->
<ng-template #email>
    <form #emailForm="ngForm" novalidate>
        <div class="popup_content add_activity_height cstm_scroll_bg">
            <div class="row">
                <div *ngIf="personInfo" class="col-md-12 col-sm-12 activity_bar_info">
                    <div *ngTemplateOutlet="personinfo"></div>
                </div>
            </div>
            <div class="sch_white_bg">
                <div class="smallScheduler">
                    <div class="row">
                        <div class="col-md-12">
                            <h5 class="field_label">Subject</h5>
                            <div [ngClass]="{
                               'has-danger': emailSubject.invalid && (emailSubject.dirty || emailSubject.touched || isInvalidData),
                               'has-success': emailSubject.valid && (emailSubject.dirty || emailSubject.touched)
                            }">
                                <input class="form-control" type="text" name="emailSubject" [(ngModel)]="emailModel.EmailSubject" #emailSubject="ngModel" maxlength="50" required tabindex="1" />
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6">
                            <h5 class="field_label">Contact Reason</h5>
                            <div [ngClass]="{
                                'has-danger': emailContactReasonID.invalid && (emailContactReasonID.dirty || emailContactReasonID.touched || isInvalidData),
                                'has-success': emailContactReasonID.valid && (emailContactReasonID.dirty || emailContactReasonID.touched)
                            }">
                                <div class="select_label">
                                    <select class="form-control" name="emailContactReasonID" [(ngModel)]="emailModel.ContactReasonTypeID" #emailContactReasonID="ngModel" required>
                                <option *ngFor="let constactReasonType of contactReasonList"
                                    [ngValue]="constactReasonType.ContactReasonTypeID">
                                    {{constactReasonType.ContactReasonTypeName}}
                                </option>
                            </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6">
                            <h5 class="field_label">Template</h5>
                            <div class="select_label">
                                <select class="form-control" name="txtTemplateTextID" [(ngModel)]="selectedTemplate" (ngModelChange)="onTemplateChange(selectedTemplate)" #templateTextID="ngModel" tabindex="2">
                            <option *ngFor="let template of templateTextList" [ngValue]="template">
                                {{template.TemplateTextTitle}}
                            </option>
                        </select>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <h5 class="field_label">
                                Text <span>(Remaining Characters: {{ emailMaxLength - emailModel?.EmailBody?.length}})</span>
                            </h5>
                            <div [ngClass]="{
                        'has-danger': (emailBody.invalid && isInvalidData) || isInvalidEmailBody
                    }">
                                <email-editor [value]="emailModel?.EmailBody" (onEmailBodyChange)="onEmailBodyChange($event)">
                                </email-editor>
                            </div>
                            <input type="text" name="emailBody" #emailBody="ngModel" [(ngModel)]="emailModel.EmailBody" required [maxlength]="emailMaxLength" style="display: none" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</ng-template>

<!-- Notes Template-->
<ng-template #note>
    <form #noteForm="ngForm" novalidate>
        <div class="popup_content add_activity_height cstm_scroll_bg">
            <div class="row">
                <div *ngIf="personInfo" class="col-md-12 col-sm-12 activity_bar_info">
                    <div *ngTemplateOutlet="personinfo"></div>
                </div>
            </div>
            <div class="sch_white_bg">
                <div class="smallScheduler">
                    <div class="row">
                        <div class="col-sm-12 col-md-12">
                            <div class="field_label">
                                <h5>Title</h5>
                            </div>
                            <div [ngClass]="{
                               'has-danger': noteTitle.invalid && (noteTitle.dirty || noteTitle.touched || isInvalidData),
                               'has-success': noteTitle.valid && (noteTitle.dirty || noteTitle.touched)
                            }">
                                <input class="form-control" type="text" name="noteTitle" [(ngModel)]="noteModel.Title" #noteTitle="ngModel" maxlength="50" required tabindex="1" />
                            </div>

                            <div class="field_label">
                                <h5>Description <span>(Remaining Characters: {{ 500 -
                                noteModel?.Description?.length }})</span></h5>
                            </div>
                            <div [ngClass]="{
                               'has-danger': noteDescription.invalid && (noteDescription.dirty || noteDescription.touched || isInvalidData),
                               'has-success': noteDescription.valid && (noteDescription.dirty || noteDescription.touched)
                             }">
                                <textarea class="form-control form-control-description" rows="12" name="noteDescription" #noteDescription="ngModel" [(ngModel)]="noteModel.Description" maxlength="500" required tabindex="2">
                </textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</ng-template>

<!-- SMS Template -->
<ng-template #sms>
    <form #smsForm="ngForm" novalidate>
        <div class="popup_content add_activity_height cstm_scroll_bg">
            <div class="row">
                <div *ngIf="personInfo" class="col-md-12 col-sm-12 activity_bar_info">
                    <div *ngTemplateOutlet="personinfo"></div>
                </div>
            </div>
            <div class="sch_white_bg">
                <div class="smallScheduler">
                    <div class="row">
                        <div class="col-md-12 no_padding">
                            <p class="alert alert-warning sms-warning" *ngIf="personInfo?.Mobile == ''"><i class="fal fa-exclamation-circle"></i> Please add mobile number in {{personInfo.CustomerTypeName}} profile to send SMS</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <h5 class="field_label">Title</h5>
                            <div [ngClass]="{
                               'has-danger': smsTitle.invalid && (smsTitle.dirty || smsTitle.touched || isInvalidData),
                               'has-success': smsTitle.valid && (smsTitle.dirty || smsTitle.touched)
                            }">
                                <input class="form-control" type="text" name="txtSmsTitle" [(ngModel)]="smsModel.Title" #smsTitle="ngModel" maxlength="50" required tabindex="1" />
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6">
                            <h5 class="field_label">Contact Reason</h5>
                            <div [ngClass]="{
                                'has-danger': smsContactReasonID.invalid && (smsContactReasonID.dirty || smsContactReasonID.touched || isInvalidData),
                                'has-success': smsContactReasonID.valid && (smsContactReasonID.dirty || smsContactReasonID.touched)
                            }">
                                <div class="select_label">
                                    <select class="form-control" name="smsContactReasonID" [(ngModel)]="smsModel.ContactReasonTypeID" #smsContactReasonID="ngModel" required>
                                <option *ngFor="let constactReasonType of contactReasonList"
                                    [ngValue]="constactReasonType.ContactReasonTypeID">
                                    {{constactReasonType.ContactReasonTypeName}}
                                </option>
                            </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6">
                            <h5 class="field_label">Template</h5>
                            <div class="select_label">
                                <select class="form-control" name="txtTemplateTextID" [(ngModel)]="selectedTemplate" (ngModelChange)="onTemplateChange(selectedTemplate)" #templateTextID="ngModel" tabindex="2">
                            <option *ngFor="let template of templateTextList" [ngValue]="template">
                                {{template.TemplateTextTitle}}
                            </option>
                        </select>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <h5 class="field_label">Text <span>(Remaining Characters: {{ 160 -
                            smsModel?.Description?.length }})</span></h5>
                            <div [ngClass]="{
                               'has-danger': smsDescription.invalid && (smsDescription.dirty || smsDescription.touched || isInvalidData),
                               'has-success': smsDescription.valid && (smsDescription.dirty || smsDescription.touched)
                             }">
                                <textarea class="form-control form-control-description" rows="8" name="txtSmsDescription" #smsDescription="ngModel" [(ngModel)]="smsModel.Description" maxlength="160" required tabindex="3">
                    </textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</ng-template>

<!-- App Notification Template-->
<ng-template #appNotification>
    <form #appNotificationForm="ngForm" novalidate>
        <div class="popup_content add_activity_height cstm_scroll_bg">
            <div class="row">
                <div *ngIf="personInfo" class="col-md-12 col-sm-12 activity_bar_info">
                    <div *ngTemplateOutlet="personinfo"></div>
                </div>
            </div>
            <div class="sch_white_bg">
                <div class="smallScheduler">
                    <div class="row">
                        <div class="col-md-12">
                            <h5 class="field_label">Title</h5>
                            <div [ngClass]="{
                               'has-danger': appNotificationTitle.invalid && (appNotificationTitle.dirty || appNotificationTitle.touched || isInvalidData),
                               'has-success': appNotificationTitle.valid && (appNotificationTitle.dirty || appNotificationTitle.touched)
                            }">
                                <input class="form-control" type="text" name="txtAppNotificationTitle" [(ngModel)]="appNotificationModel.Title" #appNotificationTitle="ngModel" maxlength="50" required />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="field_label">
                                <h5>Contact Reason</h5>
                            </div>
                            <div [ngClass]="{
                             'has-danger': appNotificationContactReasonTypeID.invalid && (appNotificationContactReasonTypeID.dirty || appNotificationContactReasonTypeID.touched || isInvalidData),
                             'has-success': appNotificationContactReasonTypeID.valid && (appNotificationContactReasonTypeID.dirty || appNotificationContactReasonTypeID.touched)
                          }">
                                <div class="select_label">
                                    <select class="form-control" name="appNotificationContactReason" [(ngModel)]="appNotificationModel.ContactReasonTypeID" #appNotificationContactReasonTypeID="ngModel" required>
                                <option *ngFor="let contactReason of contactReasonList"
                                    [ngValue]="contactReason.ContactReasonTypeID">
                                    {{contactReason.ContactReasonTypeName}}
                                </option>
                            </select>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="col-md-6">
                    <div class="field_label">
                        <h5>SMS Template</h5>
                    </div>
                    <div class="select_label">
                        <select class="form-control" name="txtTemplateTextID" [(ngModel)]="selectedTemplate"
                            (ngModelChange)="onTemplateChange(selectedTemplate)" #templateTextID="ngModel">
                            <option *ngFor="let template of templateTextList" [ngValue]="template">
                                {{template.TemplateTextTitle}}
                            </option>
                        </select>
                    </div>
                </div> -->
                        <div class="col-md-12">
                            <h5 class="field_label">Text <span>(Remaining Characters: {{ 300 -
                            appNotificationModel?.Description?.length
                            }})</span></h5>
                            <div [ngClass]="{
                               'has-danger': appNotificationDescription.invalid && (appNotificationDescription.dirty || appNotificationDescription.touched || isInvalidData),
                               'has-success': appNotificationDescription.valid && (appNotificationDescription.dirty || appNotificationDescription.touched)
                             }">
                                <textarea class="form-control form-control-description" rows="10" name="txtAppNotificationDescription" #appNotificationDescription="ngModel" [(ngModel)]="appNotificationModel.Description" maxlength="300" required>
                    </textarea>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <p class="alert alert-warning sms-warning" *ngIf="personInfo?.Mobile == ''"><i class="fal fa-exclamation-circle"></i> Please add mobile number in {{personInfo.CustomerTypeName}} profile to send App Notification</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</ng-template>

<!-- Achievements Template-->
<ng-template #Achievements>
    <form #achievementsForm="ngForm" novalidate>
        <div class="popup_content add_activity_height">
            <div class="row">
                <div *ngIf="personInfo" class="col-md-12 col-sm-12 activity_bar_info">
                    <div *ngTemplateOutlet="personinfo"></div>
                </div>
            </div>
            <div class="sch_white_bg">
                <div class="smallScheduler">
                    <div class="row">
                        <div class="col-sm-12 col-md-12">
                            <div class="field_label">
                                <h5>Title</h5>
                            </div>
                            <input class="form-control" name="achievementTitle" [(ngModel)]="achievementModel.Title" #achievementTitle="ngModel" type="text" maxlength="50" required tabindex="1" />
                        </div>
                        <div class="col-sm-12 col-md-12">
                            <div class="field_label">
                                <h5>Notes <span>(Remaining Characters: {{ 500 - achievementModel?.Description?.length }})</span>
                                </h5>
                            </div>
                            <textarea class="form-control form-control-description" rows="12" name="achievementDescription" [(ngModel)]="achievementModel.Description" #achievementDescription="ngModel" type="text" maxlength="500" tabindex="2">
                        </textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</ng-template>